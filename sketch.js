const trainingData = [[
  {
    "high":187.85,
    "low":184.74,
    "volume":60800000.0
  },
  {
    "high":189.12,
    "low":187.48,
    "volume":60800000.0
  },
  {
    "high":189.92,
    "low":188.28,
    "volume":45700000.0
  },
  {
    "high":189.98,
    "low":187.61,
    "volume":45300000.0
  },
  {
    "high":188.85,
    "low":181.47,
    "volume":81800000.0
  },
  {
    "high":178.21,
    "low":173.54,
    "volume":112000000.0
  },
  {
    "high":180.24,
    "low":177.79,
    "volume":65600000.0
  },
  {
    "high":180.3,
    "low":177.34,
    "volume":59000000.0
  },
  {
    "high":180.13,
    "low":174.82,
    "volume":90400000.0
  },
  {
    "high":177.3,
    "low":173.98,
    "volume":84300000.0
  },
  {
    "high":176.1,
    "low":173.58,
    "volume":60900000.0
  },
  {
    "high":176.5,
    "low":173.82,
    "volume":109000000.0
  },
  {
    "high":179.38,
    "low":176.17,
    "volume":67300000.0
  },
  {
    "high":179.63,
    "low":177.13,
    "volume":51800000.0
  },
  {
    "high":179.7,
    "low":175.4,
    "volume":58400000.0
  },
  {
    "high":176.3,
    "low":173.86,
    "volume":63000000.0
  },
  {
    "high":177.08,
    "low":174.05,
    "volume":56700000.0
  },
  {
    "high":176.97,
    "low":174.15,
    "volume":46200000.0
  },
  {
    "high":175.2,
    "low":171.66,
    "volume":64600000.0
  },
  {
    "high":173.04,
    "low":169.05,
    "volume":66900000.0
  },
  {
    "high":172.03,
    "low":167.62,
    "volume":56300000.0
  },
  {
    "high":173.07,
    "low":170.34,
    "volume":51800000.0
  },
  {
    "high":174.3,
    "low":170.93,
    "volume":52200000.0
  },
  {
    "high":173.63,
    "low":170.82,
    "volume":49600000.0
  },
  {
    "high":174.21,
    "low":170.97,
    "volume":53000000.0
  },
  {
    "high":175.45,
    "low":172.68,
    "volume":48500000.0
  },
  {
    "high":177.99,
    "low":173.18,
    "volume":57200000.0
  },
  {
    "high":179.05,
    "low":175.8,
    "volume":42400000.0
  },
  {
    "high":179.72,
    "low":177.95,
    "volume":43700000.0
  },
  {
    "high":179.85,
    "low":177.6,
    "volume":47600000.0
  },
  {
    "high":182.34,
    "low":179.04,
    "volume":56700000.0
  },
  {
    "high":181.93,
    "low":178.14,
    "volume":51400000.0
  },
  {
    "high":179.08,
    "low":176.51,
    "volume":52500000.0
  },
  {
    "high":178.42,
    "low":174.8,
    "volume":57500000.0
  },
  {
    "high":177.58,
    "low":175.11,
    "volume":54800000.0
  },
  {
    "high":177.84,
    "low":175.19,
    "volume":59300000.0
  },
  {
    "high":175.42,
    "low":172.64,
    "volume":64200000.0
  },
  {
    "high":174.01,
    "low":169.93,
    "volume":56000000.0
  },
  {
    "high":173.67,
    "low":171.45,
    "volume":43800000.0
  },
  {
    "high":173.06,
    "low":170.65,
    "volume":57200000.0
  },
  {
    "high":171.38,
    "low":165.67,
    "volume":70600000.0
  },
  {
    "high":168.96,
    "low":166.83,
    "volume":58500000.0
  },
  {
    "high":171.17,
    "low":168.87,
    "volume":51100000.0
  },
  {
    "high":170.9,
    "low":167.9,
    "volume":44800000.0
  },
  {
    "high":174.23,
    "low":170.12,
    "volume":56900000.0
  },
  {
    "high":177.78,
    "low":175.46,
    "volume":77300000.0
  },
  {
    "high":176.82,
    "low":173.35,
    "volume":79800000.0
  },
  {
    "high":179.43,
    "low":176.21,
    "volume":63800000.0
  },
  {
    "high":182.44,
    "low":178.97,
    "volume":70500000.0
  },
  {
    "high":183.45,
    "low":181.59,
    "volume":49300000.0
  },
  {
    "high":184.12,
    "low":181.81,
    "volume":53800000.0
  },
  {
    "high":186.57,
    "low":183.53,
    "volume":66100000.0
  },
  {
    "high":186.03,
    "low":184.21,
    "volume":43600000.0
  },
  {
    "high":188.11,
    "low":186.3,
    "volume":60100000.0
  },
  {
    "high":189.5,
    "low":187.78,
    "volume":53800000.0
  },
  {
    "high":190.96,
    "low":188.65,
    "volume":54400000.0
  },
  {
    "high":190.38,
    "low":188.57,
    "volume":50900000.0
  },
  {
    "high":191.91,
    "low":189.88,
    "volume":46500000.0
  },
  {
    "high":191.52,
    "low":189.74,
    "volume":38100000.0
  },
  {
    "high":192.93,
    "low":190.83,
    "volume":39600000.0
  },
  {
    "high":190.9,
    "low":189.25,
    "volume":24000000.0
  },
  {
    "high":190.67,
    "low":188.9,
    "volume":40600000.0
  },
  {
    "high":191.08,
    "low":189.4,
    "volume":38400000.0
  },
  {
    "high":192.09,
    "low":188.97,
    "volume":43000000.0
  },
  {
    "high":190.32,
    "low":188.19,
    "volume":48800000.0
  },
  {
    "high":191.56,
    "low":189.23,
    "volume":45700000.0
  },
  {
    "high":190.05,
    "low":187.45,
    "volume":43400000.0
  },
  {
    "high":194.4,
    "low":190.18,
    "volume":66600000.0
  },
  {
    "high":194.76,
    "low":192.11,
    "volume":41100000.0
  },
  {
    "high":195.0,
    "low":193.59,
    "volume":47500000.0
  },
  {
    "high":195.99,
    "low":193.67,
    "volume":53400000.0
  },
  {
    "high":193.49,
    "low":191.42,
    "volume":60900000.0
  },
  {
    "high":194.72,
    "low":191.72,
    "volume":52700000.0
  },
  {
    "high":198.0,
    "low":194.85,
    "volume":70400000.0
  },
  {
    "high":199.62,
    "low":196.16,
    "volume":66800000.0
  },
  {
    "high":198.4,
    "low":197.0,
    "volume":128000000.0
  },
  {
    "high":196.63,
    "low":194.39,
    "volume":55800000.0
  },
  {
    "high":196.95,
    "low":195.89,
    "volume":40700000.0
  },
  {
    "high":197.68,
    "low":194.83,
    "volume":52200000.0
  },
  {
    "high":197.08,
    "low":193.5,
    "volume":46500000.0
  },
  {
    "high":195.41,
    "low":192.97,
    "volume":37100000.0
  },
  {
    "high":193.89,
    "low":192.83,
    "volume":28900000.0
  },
  {
    "high":193.5,
    "low":191.09,
    "volume":48100000.0
  },
  {
    "high":194.66,
    "low":193.17,
    "volume":34000000.0
  },
  {
    "high":194.4,
    "low":191.73,
    "volume":42600000.0
  },
  {
    "high":188.44,
    "low":183.89,
    "volume":82500000.0
  },
  {
    "high":185.88,
    "low":183.43,
    "volume":58400000.0
  },
  {
    "high":183.09,
    "low":180.88,
    "volume":72000000.0
  },
  {
    "high":182.76,
    "low":180.17,
    "volume":62300000.0
  },
  {
    "high":185.6,
    "low":181.5,
    "volume":59100000.0
  },
  {
    "high":185.15,
    "low":182.73,
    "volume":42800000.0
  },
  {
    "high":186.4,
    "low":183.92,
    "volume":46800000.0
  },
  {
    "high":187.05,
    "low":183.62,
    "volume":49100000.0
  },
  {
    "high":186.74,
    "low":185.19,
    "volume":40400000.0
  },
  {
    "high":184.26,
    "low":180.93,
    "volume":65600000.0
  },
  {
    "high":182.93,
    "low":180.3,
    "volume":47300000.0
  },
  {
    "high":189.14,
    "low":185.83,
    "volume":78000000.0
  },
  {
    "high":191.95,
    "low":188.82,
    "volume":68700000.0
  },
  {
    "high":195.33,
    "low":192.26,
    "volume":60100000.0
  },
  {
    "high":195.75,
    "low":193.83,
    "volume":42400000.0
  },
  {
    "high":196.38,
    "low":194.34,
    "volume":53600000.0
  },
  {
    "high":196.27,
    "low":193.11,
    "volume":54800000.0
  },
  {
    "high":194.76,
    "low":191.94,
    "volume":44600000.0
  },
  {
    "high":192.2,
    "low":189.58,
    "volume":47100000.0
  },
  {
    "high":191.8,
    "low":187.47,
    "volume":55900000.0
  },
  {
    "high":187.1,
    "low":184.35,
    "volume":55500000.0
  },
  {
    "high":186.95,
    "low":183.82,
    "volume":64900000.0
  },
  {
    "high":187.33,
    "low":179.25,
    "volume":103000000.0
  },
  {
    "high":189.25,
    "low":185.84,
    "volume":69700000.0
  },
  {
    "high":189.31,
    "low":186.77,
    "volume":43500000.0
  },
  {
    "high":191.05,
    "low":188.61,
    "volume":53400000.0
  },
  {
    "high":189.54,
    "low":187.35,
    "volume":41000000.0
  },
  {
    "high":189.99,
    "low":188.0,
    "volume":45200000.0
  },
  {
    "high":188.67,
    "low":186.79,
    "volume":41800000.0
  },
  {
    "high":186.21,
    "low":183.51,
    "volume":56500000.0
  },
  {
    "high":185.53,
    "low":182.44,
    "volume":54600000.0
  },
  {
    "high":184.49,
    "low":181.35,
    "volume":65400000.0
  },
  {
    "high":184.85,
    "low":181.67,
    "volume":49700000.0
  },
  {
    "high":182.43,
    "low":180.0,
    "volume":53700000.0
  },
  {
    "high":182.89,
    "low":180.66,
    "volume":41500000.0
  },
  {
    "high":184.96,
    "low":182.46,
    "volume":52300000.0
  },
  {
    "high":185.04,
    "low":182.23,
    "volume":45100000.0
  },
  {
    "high":182.76,
    "low":180.65,
    "volume":40900000.0
  },
  {
    "high":183.92,
    "low":179.56,
    "volume":54300000.0
  },
  {
    "high":183.12,
    "low":180.13,
    "volume":49000000.0
  },
  {
    "high":182.57,
    "low":179.53,
    "volume":137000000.0
  },
  {
    "high":180.53,
    "low":177.38,
    "volume":73500000.0
  },
  {
    "high":176.9,
    "low":173.79,
    "volume":81500000.0
  },
  {
    "high":172.04,
    "low":169.62,
    "volume":95100000.0
  },
  {
    "high":171.24,
    "low":168.68,
    "volume":68600000.0
  },
  {
    "high":170.73,
    "low":168.49,
    "volume":71800000.0
  },
  {
    "high":173.7,
    "low":168.94,
    "volume":76100000.0
  },
  {
    "high":174.38,
    "low":172.05,
    "volume":60100000.0
  },
  {
    "high":174.03,
    "low":171.01,
    "volume":59800000.0
  },
  {
    "high":173.19,
    "low":170.76,
    "volume":52500000.0
  },
  {
    "high":174.31,
    "low":172.05,
    "volume":72900000.0
  },
  {
    "high":172.62,
    "low":170.29,
    "volume":122000000.0
  },
  {
    "high":177.71,
    "low":173.52,
    "volume":75600000.0
  },
  {
    "high":176.61,
    "low":173.03,
    "volume":55200000.0
  },
  {
    "high":178.67,
    "low":175.09,
    "volume":53400000.0
  },
  {
    "high":177.49,
    "low":170.84,
    "volume":106000000.0
  },
  {
    "high":173.05,
    "low":170.06,
    "volume":71100000.0
  },
  {
    "high":171.94,
    "low":169.45,
    "volume":54300000.0
  },
  {
    "high":171.42,
    "low":169.58,
    "volume":57400000.0
  },
  {
    "high":173.6,
    "low":170.11,
    "volume":60300000.0
  },
  {
    "high":172.23,
    "low":170.51,
    "volume":65700000.0
  },
  {
    "high":171.25,
    "low":169.48,
    "volume":46200000.0
  },
  {
    "high":169.34,
    "low":168.23,
    "volume":49300000.0
  },
  {
    "high":170.68,
    "low":168.58,
    "volume":47700000.0
  },
  {
    "high":171.92,
    "low":168.82,
    "volume":53700000.0
  },
  {
    "high":170.39,
    "low":168.95,
    "volume":42100000.0
  },
  {
    "high":169.2,
    "low":168.24,
    "volume":37400000.0
  },
  {
    "high":170.08,
    "low":168.35,
    "volume":42500000.0
  },
  {
    "high":169.09,
    "low":167.11,
    "volume":49700000.0
  },
  {
    "high":175.46,
    "low":168.16,
    "volume":91100000.0
  },
  {
    "high":178.36,
    "low":174.21,
    "volume":102000000.0
  },
  {
    "high":176.63,
    "low":172.5,
    "volume":73500000.0
  },
  {
    "high":173.76,
    "low":168.27,
    "volume":73700000.0
  },
  {
    "high":170.65,
    "low":168.0,
    "volume":50900000.0
  },
  {
    "high":168.64,
    "low":166.55,
    "volume":43100000.0
  },
  {
    "high":166.4,
    "low":164.08,
    "volume":67800000.0
  },
  {
    "high":167.26,
    "low":164.77,
    "volume":48100000.0
  },
  {
    "high":167.05,
    "low":164.92,
    "volume":49500000.0
  },
  {
    "high":169.3,
    "low":166.21,
    "volume":48300000.0
  },
  {
    "high":170.61,
    "low":168.15,
    "volume":50600000.0
  },
  {
    "high":171.34,
    "low":169.18,
    "volume":44800000.0
  },
  {
    "high":176.03,
    "low":173.1,
    "volume":68200000.0
  },
  {
    "high":174.99,
    "low":170.0,
    "volume":65900000.0
  },
  {
    "high":172.71,
    "low":169.11,
    "volume":50400000.0
  },
  {
    "high":173.42,
    "low":170.89,
    "volume":94200000.0
  },
  {
    "high":187.0,
    "low":182.66,
    "volume":163000000.0
  },
  {
    "high":184.2,
    "low":180.42,
    "volume":78600000.0
  },
  {
    "high":184.9,
    "low":181.32,
    "volume":77300000.0
  },
  {
    "high":183.07,
    "low":181.45,
    "volume":45100000.0
  },
  {
    "high":184.66,
    "low":182.11,
    "volume":49000000.0
  },
  {
    "high":185.09,
    "low":182.13,
    "volume":50800000.0
  },
  {
    "high":187.1,
    "low":184.62,
    "volume":72000000.0
  },
  {
    "high":188.3,
    "low":186.29,
    "volume":52400000.0
  },
  {
    "high":190.65,
    "low":187.37,
    "volume":70400000.0
  },
  {
    "high":191.1,
    "low":189.66,
    "volume":52800000.0
  },
  {
    "high":190.81,
    "low":189.18,
    "volume":41300000.0
  },
  {
    "high":191.92,
    "low":189.01,
    "volume":44400000.0
  },
  {
    "high":192.73,
    "low":190.92,
    "volume":42300000.0
  },
  {
    "high":192.82,
    "low":190.27,
    "volume":34600000.0
  },
  {
    "high":191.0,
    "low":186.63,
    "volume":51000000.0
  },
  {
    "high":190.58,
    "low":188.04,
    "volume":36300000.0
  },
  {
    "high":193.0,
    "low":189.1,
    "volume":52300000.0
  },
  {
    "high":192.25,
    "low":189.51,
    "volume":53100000.0
  },
  {
    "high":192.18,
    "low":190.63,
    "volume":49900000.0
  },
  {
    "high":192.57,
    "low":189.91,
    "volume":75200000.0
  },
  {
    "high":194.99,
    "low":192.52,
    "volume":50100000.0
  },
  {
    "high":195.32,
    "low":193.03,
    "volume":47500000.0
  },
  {
    "high":196.9,
    "low":194.87,
    "volume":54200000.0
  },
  {
    "high":196.5,
    "low":194.17,
    "volume":41200000.0
  },
  {
    "high":196.94,
    "low":194.14,
    "volume":53100000.0
  },
  {
    "high":197.3,
    "low":192.15,
    "volume":97300000.0
  },
  {
    "high":207.16,
    "low":193.63,
    "volume":172000000.0
  },
  {
    "high":220.2,
    "low":206.9,
    "volume":198000000.0
  },
  {
    "high":216.75,
    "low":211.6,
    "volume":97900000.0
  },
  {
    "high":215.17,
    "low":211.3,
    "volume":70100000.0
  },
  {
    "high":218.95,
    "low":212.72,
    "volume":93700000.0
  },
  {
    "high":218.63,
    "low":213.0,
    "volume":79900000.0
  },
  {
    "high":214.24,
    "low":208.85,
    "volume":86200000.0
  },
  {
    "high":211.89,
    "low":207.11,
    "volume":246000000.0
  },
  {
    "high":212.7,
    "low":206.59,
    "volume":80700000.0
  },
  {
    "high":211.38,
    "low":208.61,
    "volume":56700000.0
  },
  {
    "high":214.86,
    "low":210.64,
    "volume":66200000.0
  },
  {
    "high":215.74,
    "low":212.35,
    "volume":49800000.0
  },
  {
    "high":216.07,
    "low":210.3,
    "volume":82500000.0
  },
  {
    "high":217.51,
    "low":211.92,
    "volume":60400000.0
  },
  {
    "high":220.38,
    "low":215.1,
    "volume":58000000.0
  },
  {
    "high":221.55,
    "low":219.03,
    "volume":37400000.0
  },
  {
    "high":226.45,
    "low":221.65,
    "volume":60400000.0
  },
  {
    "high":227.85,
    "low":223.25,
    "volume":59100000.0
  },
  {
    "high":229.4,
    "low":226.37,
    "volume":48100000.0
  },
  {
    "high":233.08,
    "low":229.25,
    "volume":62600000.0
  },
  {
    "high":232.39,
    "low":225.77,
    "volume":64700000.0
  },
  {
    "high":232.64,
    "low":228.68,
    "volume":53000000.0
  },
  {
    "high":237.23,
    "low":233.09,
    "volume":62600000.0
  },
  {
    "high":236.27,
    "low":232.33,
    "volume":43200000.0
  },
  {
    "high":231.46,
    "low":226.64,
    "volume":57300000.0
  },
  {
    "high":230.44,
    "low":222.27,
    "volume":66000000.0
  },
  {
    "high":226.8,
    "low":223.28,
    "volume":49200000.0
  },
  {
    "high":227.78,
    "low":223.09,
    "volume":48200000.0
  },
  {
    "high":226.94,
    "low":222.68,
    "volume":40000000.0
  },
  {
    "high":224.8,
    "low":217.13,
    "volume":61800000.0
  },
  {
    "high":220.85,
    "low":214.62,
    "volume":51400000.0
  },
  {
    "high":219.49,
    "low":216.01,
    "volume":41600000.0
  },
  {
    "high":219.3,
    "low":215.75,
    "volume":36300000.0
  },
  {
    "high":220.33,
    "low":216.12,
    "volume":41600000.0
  },
  {
    "high":223.82,
    "low":220.63,
    "volume":50000000.0
  },
  {
    "high":224.48,
    "low":217.02,
    "volume":62500000.0
  },
  {
    "high":225.6,
    "low":217.71,
    "volume":106000000.0
  },
  {
    "high":213.5,
    "low":196.0,
    "volume":120000000.0
  },
  {
    "high":209.99,
    "low":201.07,
    "volume":69700000.0
  },
  {
    "high":213.64,
    "low":206.39,
    "volume":63500000.0
  },
  {
    "high":214.2,
    "low":208.83,
    "volume":47200000.0
  },
  {
    "high":216.78,
    "low":211.97,
    "volume":42200000.0
  },
  {
    "high":219.51,
    "low":215.6,
    "volume":38000000.0
  },
  {
    "high":221.89,
    "low":219.01,
    "volume":44200000.0
  },
  {
    "high":223.03,
    "low":219.7,
    "volume":42000000.0
  },
  {
    "high":225.35,
    "low":222.76,
    "volume":46400000.0
  },
  {
    "high":226.83,
    "low":223.65,
    "volume":44300000.0
  },
  {
    "high":225.99,
    "low":223.04,
    "volume":40700000.0
  },
  {
    "high":227.17,
    "low":225.45,
    "volume":30300000.0
  },
  {
    "high":227.98,
    "low":225.05,
    "volume":34800000.0
  },
  {
    "high":228.34,
    "low":223.9,
    "volume":43700000.0
  },
  {
    "high":228.22,
    "low":224.33,
    "volume":38700000.0
  },
  {
    "high":227.28,
    "low":223.89,
    "volume":30600000.0
  },
  {
    "high":228.85,
    "low":224.89,
    "volume":35900000.0
  },
  {
    "high":229.86,
    "low":225.68,
    "volume":38100000.0
  },
  {
    "high":232.92,
    "low":228.88,
    "volume":51900000.0
  },
  {
    "high":230.4,
    "low":227.48,
    "volume":53000000.0
  },
  {
    "high":229.0,
    "low":221.17,
    "volume":50200000.0
  },
  {
    "high":221.78,
    "low":217.48,
    "volume":43800000.0
  },
  {
    "high":225.48,
    "low":221.52,
    "volume":36600000.0
  },
  {
    "high":225.24,
    "low":219.77,
    "volume":48400000.0
  },
  {
    "high":221.27,
    "low":216.71,
    "volume":67200000.0
  },
  {
    "high":221.48,
    "low":216.73,
    "volume":51600000.0
  },
  {
    "high":223.09,
    "low":217.89,
    "volume":44600000.0
  },
  {
    "high":223.55,
    "low":219.82,
    "volume":37500000.0
  },
  {
    "high":224.04,
    "low":221.91,
    "volume":36800000.0
  },
  {
    "high":217.22,
    "low":213.92,
    "volume":59400000.0
  },
  {
    "high":216.9,
    "low":214.5,
    "volume":45500000.0
  },
  {
    "high":222.71,
    "low":217.54,
    "volume":59900000.0
  },
  {
    "high":229.82,
    "low":224.63,
    "volume":66800000.0
  },
  {
    "high":233.09,
    "low":227.62,
    "volume":319000000.0
  },
  {
    "high":229.45,
    "low":225.81,
    "volume":54100000.0
  },
  {
    "high":229.35,
    "low":225.73,
    "volume":43600000.0
  },
  {
    "high":227.29,
    "low":224.02,
    "volume":42300000.0
  },
  {
    "high":228.5,
    "low":225.41,
    "volume":36600000.0
  },
  {
    "high":229.52,
    "low":227.3,
    "volume":34000000.0
  },
  {
    "high":233.0,
    "low":229.65,
    "volume":54500000.0
  },
  {
    "high":229.65,
    "low":223.74,
    "volume":63300000.0
  },
  {
    "high":227.37,
    "low":223.02,
    "volume":32900000.0
  },
  {
    "high":226.81,
    "low":223.32,
    "volume":34000000.0
  },
  {
    "high":228.0,
    "low":224.13,
    "volume":37200000.0
  },
  {
    "high":225.69,
    "low":221.33,
    "volume":39500000.0
  },
  {
    "high":225.98,
    "low":223.25,
    "volume":31900000.0
  },
  {
    "high":229.75,
    "low":224.83,
    "volume":33600000.0
  },
  {
    "high":229.5,
    "low":227.17,
    "volume":28200000.0
  },
  {
    "high":229.41,
    "low":227.34,
    "volume":31800000.0
  },
  {
    "high":231.73,
    "low":228.6,
    "volume":39900000.0
  },
  {
    "high":237.49,
    "low":232.37,
    "volume":64800000.0
  },
  {
    "high":232.12,
    "low":229.84,
    "volume":34100000.0
  },
  {
    "high":233.85,
    "low":230.52,
    "volume":33000000.0
  },
  {
    "high":236.18,
    "low":234.01,
    "volume":46400000.0
  },
  {
    "high":236.85,
    "low":234.45,
    "volume":36300000.0
  },
  {
    "high":236.22,
    "low":232.6,
    "volume":38800000.0
  },
  {
    "high":235.14,
    "low":227.76,
    "volume":52300000.0
  },
  {
    "high":230.82,
    "low":228.41,
    "volume":31100000.0
  },
  {
    "high":233.22,
    "low":229.57,
    "volume":38800000.0
  },
  {
    "high":234.73,
    "low":232.55,
    "volume":36100000.0
  },
  {
    "high":234.33,
    "low":232.32,
    "volume":35400000.0
  },
  {
    "high":233.47,
    "low":229.55,
    "volume":47100000.0
  },
  {
    "high":229.83,
    "low":225.37,
    "volume":64400000.0
  },
  {
    "high":225.35,
    "low":220.27,
    "volume":65300000.0
  },
  {
    "high":222.79,
    "low":219.71,
    "volume":44900000.0
  },
  {
    "high":223.95,
    "low":221.14,
    "volume":28100000.0
  },
  {
    "high":226.07,
    "low":221.19,
    "volume":54600000.0
  },
  {
    "high":227.88,
    "low":224.57,
    "volume":42100000.0
  },
  {
    "high":228.66,
    "low":226.41,
    "volume":38300000.0
  },
  {
    "high":225.7,
    "low":221.5,
    "volume":42000000.0
  },
  {
    "high":225.59,
    "low":223.36,
    "volume":40400000.0
  },
  {
    "high":226.65,
    "low":222.76,
    "volume":48600000.0
  },
  {
    "high":228.87,
    "low":225.0,
    "volume":44900000.0
  },
  {
    "high":226.92,
    "low":224.27,
    "volume":47900000.0
  },
  {
    "high":229.74,
    "low":225.17,
    "volume":44700000.0
  },
  {
    "high":230.16,
    "low":226.66,
    "volume":36200000.0
  },
  {
    "high":229.93,
    "low":225.89,
    "volume":35200000.0
  },
  {
    "high":230.16,
    "low":225.71,
    "volume":42100000.0
  },
  {
    "high":230.72,
    "low":228.06,
    "volume":38200000.0
  },
  {
    "high":233.25,
    "low":229.74,
    "volume":90200000.0
  },
  {
    "high":235.57,
    "low":233.33,
    "volume":46000000.0
  },
  {
    "high":235.69,
    "low":233.81,
    "volume":33500000.0
  },
  {
    "high":237.81,
    "low":233.97,
    "volume":28500000.0
  },
  {
    "high":240.79,
    "low":237.16,
    "volume":48100000.0
  },
  {
    "high":242.76,
    "low":238.9,
    "volume":38900000.0
  },
  {
    "high":244.11,
    "low":241.25,
    "volume":44400000.0
  },
  {
    "high":244.54,
    "low":242.13,
    "volume":40000000.0
  },
  {
    "high":244.63,
    "low":242.08,
    "volume":36900000.0
  },
  {
    "high":247.24,
    "low":241.75,
    "volume":44600000.0
  },
  {
    "high":248.21,
    "low":245.34,
    "volume":36900000.0
  },
  {
    "high":250.8,
    "low":246.26,
    "volume":45200000.0
  },
  {
    "high":248.74,
    "low":245.68,
    "volume":32800000.0
  },
  {
    "high":249.29,
    "low":246.24,
    "volume":33200000.0
  },
  {
    "high":251.38,
    "low":247.65,
    "volume":51700000.0
  },
  {
    "high":253.83,
    "low":249.78,
    "volume":51400000.0
  },
  {
    "high":254.28,
    "low":247.74,
    "volume":56800000.0
  },
  {
    "high":252.0,
    "low":247.09,
    "volume":60900000.0
  },
  {
    "high":255.0,
    "low":245.69,
    "volume":147000000.0
  },
  {
    "high":255.65,
    "low":253.45,
    "volume":40900000.0
  },
  {
    "high":258.21,
    "low":255.29,
    "volume":23200000.0
  },
  {
    "high":260.1,
    "low":257.63,
    "volume":27200000.0
  },
  {
    "high":258.7,
    "low":253.06,
    "volume":42400000.0
  },
  {
    "high":253.5,
    "low":250.75,
    "volume":35600000.0
  },
  {
    "high":253.28,
    "low":249.43,
    "volume":39500000.0
  },
  {
    "high":249.1,
    "low":241.82,
    "volume":55700000.0
  },
  {
    "high":244.18,
    "low":241.89,
    "volume":40200000.0
  },
  {
    "high":247.33,
    "low":243.2,
    "volume":45000000.0
  },
  {
    "high":245.55,
    "low":241.35,
    "volume":40900000.0
  },
  {
    "high":243.71,
    "low":240.05,
    "volume":37600000.0
  },
  {
    "high":240.16,
    "low":233.0,
    "volume":61700000.0
  },
  {
    "high":234.67,
    "low":229.72,
    "volume":49600000.0
  },
  {
    "high":236.12,
    "low":232.47,
    "volume":39400000.0
  },
  {
    "high":238.96,
    "low":234.43,
    "volume":39800000.0
  },
  {
    "high":238.01,
    "low":228.03,
    "volume":71800000.0
  },
  {
    "high":232.29,
    "low":228.48,
    "volume":68500000.0
  },
  {
    "high":224.42,
    "low":219.38,
    "volume":98100000.0
  },
  {
    "high":224.12,
    "low":219.79,
    "volume":64100000.0
  },
  {
    "high":227.03,
    "low":222.3,
    "volume":60200000.0
  },
  {
    "high":225.63,
    "low":221.41,
    "volume":54700000.0
  },
  {
    "high":232.15,
    "low":223.98,
    "volume":94900000.0
  },
  {
    "high":240.19,
    "low":230.81,
    "volume":75700000.0
  },
  {
    "high":239.86,
    "low":234.01,
    "volume":45500000.0
  },
  {
    "high":240.79,
    "low":237.21,
    "volume":55700000.0
  },
  {
    "high":247.19,
    "low":233.44,
    "volume":101000000.0
  },
  {
    "high":231.83,
    "low":225.7,
    "volume":73100000.0
  },
  {
    "high":233.13,
    "low":226.65,
    "volume":45100000.0
  },
  {
    "high":232.67,
    "low":228.27,
    "volume":39600000.0
  },
  {
    "high":233.8,
    "low":230.43,
    "volume":29900000.0
  },
  {
    "high":234.0,
    "low":227.26,
    "volume":39700000.0
  },
  {
    "high":230.59,
    "low":227.2,
    "volume":33100000.0
  },
  {
    "high":235.23,
    "low":228.13,
    "volume":53700000.0
  },
  {
    "high":236.96,
    "low":230.68,
    "volume":45200000.0
  },
  {
    "high":242.34,
    "low":235.57,
    "volume":53600000.0
  },
  {
    "high":245.55,
    "low":240.99,
    "volume":40900000.0
  },
  {
    "high":245.18,
    "low":241.84,
    "volume":48800000.0
  },
  {
    "high":246.01,
    "low":243.16,
    "volume":32200000.0
  },
  {
    "high":246.78,
    "low":244.29,
    "volume":32300000.0
  },
  {
    "high":248.69,
    "low":245.22,
    "volume":53200000.0
  },
  {
    "high":248.86,
    "low":244.42,
    "volume":51300000.0
  },
  {
    "high":250.0,
    "low":244.91,
    "volume":48000000.0
  },
  {
    "high":244.98,
    "low":239.13,
    "volume":44400000.0
  },
  {
    "high":242.46,
    "low":237.06,
    "volume":41200000.0
  },
  {
    "high":242.09,
    "low":230.2,
    "volume":56800000.0
  },
  {
    "high":244.03,
    "low":236.11,
    "volume":47200000.0
  },
  {
    "high":240.07,
    "low":234.68,
    "volume":53800000.0
  },
  {
    "high":236.55,
    "low":229.23,
    "volume":47200000.0
  },
  {
    "high":237.86,
    "low":233.16,
    "volume":45200000.0
  },
  {
    "high":241.37,
    "low":234.76,
    "volume":46300000.0
  },
  {
    "high":236.16,
    "low":224.22,
    "volume":72100000.0
  },
  {
    "high":225.84,
    "low":217.45,
    "volume":76100000.0
  },
  {
    "high":221.75,
    "low":214.91,
    "volume":62500000.0
  },
  {
    "high":216.84,
    "low":208.42,
    "volume":61400000.0
  },
  {
    "high":213.95,
    "low":209.58,
    "volume":60100000.0
  },
  {
    "high":215.22,
    "low":209.97,
    "volume":48100000.0
  },
  {
    "high":215.15,
    "low":211.49,
    "volume":42400000.0
  },
  {
    "high":218.76,
    "low":213.75,
    "volume":54400000.0
  },
  {
    "high":217.49,
    "low":212.22,
    "volume":48900000.0
  },
  {
    "high":218.84,
    "low":211.28,
    "volume":94100000.0
  },
  {
    "high":221.48,
    "low":218.58,
    "volume":44300000.0
  },
  {
    "high":224.1,
    "low":220.08,
    "volume":34500000.0
  },
  {
    "high":225.02,
    "low":220.47,
    "volume":34500000.0
  },
  {
    "high":224.99,
    "low":220.56,
    "volume":37100000.0
  },
  {
    "high":223.81,
    "low":217.68,
    "volume":39800000.0
  },
  {
    "high":225.62,
    "low":216.23,
    "volume":65300000.0
  },
  {
    "high":223.68,
    "low":218.9,
    "volume":36400000.0
  },
  {
    "high":225.19,
    "low":221.02,
    "volume":35900000.0
  },
  {
    "high":207.49,
    "low":201.25,
    "volume":103000000.0
  }
]
]

const NUMBER_OF_EPOCHS = 100;
const inputs2dArray = trainingData.map((r) => r.slice(0, 3));
const outputs2dArray = trainingData.map((r) => [r[3]]);

// Normalization

const minVals = [
  Math.min(...inputs2dArray.map((r) => r[0])),
  Math.min(...inputs2dArray.map((r) => r[1])),
  Math.min(...inputs2dArray.map((r) => r[2])),
];
const maxVals = [
  Math.max(...inputs2dArray.map((r) => r[0])),
  Math.max(...inputs2dArray.map((r) => r[1])),
  Math.max(...inputs2dArray.map((r) => r[2])),
];

function normalizeData(data) {
  return data.map((row) =>
    row.map((v, i) => (v - minVals[i]) / (maxVals[i] - minVals[i]))
  );
}

const normalizedInputs = normalizeData(inputs2dArray);
const xs = tf.tensor2d(normalizedInputs);
const ys = tf.tensor2d(outputs2dArray);

// Model (multi-layer relu and sigmoid output)

const model = tf.sequential();
model.add(
  tf.layers.dense({
    inputShape: [3],
    units: 6,
    activation: "relu",
    kernelConstraint: tf.constraints.nonNeg(),
  })
);
model.add(
  tf.layers.dense({
    units: 3,
    activation: "relu",
    kernelConstraint: tf.constraints.nonNeg(),
  })
);
model.add(
  tf.layers.dense({
    units: 1,
    activation: "sigmoid",
    kernelConstraint: tf.constraints.nonNeg(),
  })
);

model.compile({
  optimizer: tf.train.adam(0.01),
  loss: "binaryCrossentropy",
  metrics: ["accuracy"],
});

// Training and confusion matrix

const spinner = document.getElementById("spinner");
const outputEl = document.getElementById("output");
const predictBtn = document.getElementById("predictBtn");
const canvas = document.getElementById("confusion");
const ctx = canvas.getContext("2d");

async function trainModel() {
  spinner.style.display = "block"; // show spinner
  outputEl.textContent = "ðŸš‚ Training model...";
  await model.fit(xs, ys, {
    epochs: NUMBER_OF_EPOCHS,
    shuffle: true,
    verbose: 0,
  });
  outputEl.textContent = "Model trained! ðŸš€ Adjust sliders and click Predict.";
  spinner.style.display = "none"; // hide spinner
  predictBtn.disabled = false;
  await drawConfusionMatrix();
}

async function drawConfusionMatrix() {
  const predictions = await model.predict(xs).data();
  let TP = 0,
    TN = 0,
    FP = 0,
    FN = 0;
  for (let i = 0; i < predictions.length; i++) {
    const pred = predictions[i] > 0.5 ? 1 : 0;
    const actual = outputs2dArray[i][0];
    if (pred === 1 && actual === 1) TP++;
    else if (pred === 0 && actual === 0) TN++;
    else if (pred === 1 && actual === 0) FP++;
    else if (pred === 0 && actual === 1) FN++;
  }

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const size = 120;
  ctx.strokeStyle = "black";
  ctx.lineWidth = 2;
  ctx.strokeRect(150, 50, size, size);
  ctx.strokeRect(150 + size, 50, size, size);
  ctx.strokeRect(150, 50 + size, size, size);
  ctx.strokeRect(150 + size, 50 + size, size, size);

  ctx.font = "16px sans-serif";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText(`TP: ${TP}`, 150 + size / 2, 50 + size / 2);
  ctx.fillText(`FP: ${FP}`, 150 + size + size / 2, 50 + size / 2);
  ctx.fillText(`FN: ${FN}`, 150 + size / 2, 50 + size + size / 2);
  ctx.fillText(`TN: ${TN}`, 150 + size + size / 2, 50 + size + size / 2);
  ctx.fillText("Actual 1", 150 + size * 0.5, 40);
  ctx.fillText("Actual 0", 150 + size * 0.5 + size, 40);
  ctx.fillText("Pred 1", 120, 50 + size * 0.5);
  ctx.fillText("Pred 0", 120, 50 + size * 0.5 + size);
}

// Prediction

function getNormalizedInput() {
  const high = parseFloat(document.getElementById("high").value);
  const exp = parseFloat(document.getElementById("low").value);
  const volume = parseFloat(document.getElementById("volume").value);
  return [
    (high - minVals[0]) / (maxVals[0] - minVals[0]),
    (exp - minVals[1]) / (maxVals[1] - minVals[1]),
    (volume - minVals[2]) / (maxVals[2] - minVals[2]),
  ];
}

function weightsStr() {
  const weights = model.getWeights()[0].dataSync();
  const bias = model.getWeights()[1].dataSync();
  return `[${Array.from(weights)
    .map((w) => w.toFixed(2))
    .join(", ")}] + bias [${Array.from(bias)
    .map((b) => b.toFixed(2))
    .join(", ")}]`;
}

function predict() {
  const inputNorm = getNormalizedInput();
  const newX = tf.tensor2d([inputNorm]);
  model
    .predict(newX)
    .data()
    .then((probArray) => {
      const prob = probArray[0];
      const result = prob > 0.5 ? 1 : 0;
      outputEl.textContent = `high: ${
        document.getElementById("high").value
      }, Years of low: ${
        document.getElementById("low").value
      }, Number of volume: ${
        document.getElementById("volume").value
      }\nHire This Applicant?: ${result} ${
        result == 1 ? "âœ…" : "âŒ"
      } (confidence ${(prob * 100).toFixed(1)}%)`;
      newX.dispose();
    });
}

// UI handlers

predictBtn.addEventListener("click", predict);
document
  .getElementById("high")
  .addEventListener(
    "input",
    (e) => (document.getElementById("highVal").textContent = e.target.value)
  );
document
  .getElementById("low")
  .addEventListener(
    "input",
    (e) => (document.getElementById("expVal").textContent = e.target.value)
  );
document
  .getElementById("volume")
  .addEventListener(
    "input",
    (e) => (document.getElementById("hikeVal").textContent = e.target.value)
  );

trainModel();

// Make 3D scatterplot

const reds = trainingData.filter((p) => p[3] === 0); 
const greens = trainingData.filter((p) => p[3] === 1);

// Format hover text for each group
const redHoverText = reds.map(
  (p) => `high: ${p[0]}<br>low: ${p[1]}<br>volume: ${p[2]}<br>hired: 0`
);
const greenHoverText = greens.map(
  (p) => `high: ${p[0]}<br>low: ${p[1]}<br>volume: ${p[2]}<br>hired: 1`
);

const redTrace = {
  x: reds.map((p) => p[0]), // high
  y: reds.map((p) => p[1]), // low
  z: reds.map((p) => p[2]), // volume
  mode: "markers",
  type: "scatter3d",
  name: "0 = Not Hired",
  text: redHoverText,
  hoverinfo: "text",
  marker: { size: 6, color: "red" },
};

const greenTrace = {
  x: greens.map((p) => p[0]),
  y: greens.map((p) => p[1]),
  z: greens.map((p) => p[2]),
  mode: "markers",
  type: "scatter3d",
  name: "1 = Hired",
  text: greenHoverText,
  hoverinfo: "text",
  marker: { size: 6, color: "green" },
};

const layout = {
  scene: {
    xaxis: { title: "high" },
    yaxis: { title: "low (Years)" },
    zaxis: { title: "Number of volume" },
  },
  margin: { l: 0, r: 0, b: 0, t: 30 },
  legend: { x: 0.8, y: 0.9 },
};

Plotly.newPlot("plot3d", [redTrace, greenTrace], layout);